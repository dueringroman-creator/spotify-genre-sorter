<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Playlist Alchemist</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Playlist Alchemist</h1>
    <button id="help-button" class="help-button" title="Show help tour">?</button>
    
    <!-- Login Section -->
    <div id="login-section" class="section">
      <button id="login" class="btn-primary">Let's see your music taste</button>
      <p class="subtitle">Discover and create personalized playlists</p>
    </div>

    <!-- Main App (hidden until logged in) -->
    <div id="app-section" class="section hidden">
      
      <!-- Welcome Tour Overlay -->
      <div id="tour-overlay" class="tour-overlay hidden">
        <div class="tour-step" id="tour-step-1">
          <div class="tour-content">
            <h3>Welcome to Playlist Alchemist</h3>
            <p>Ever saved <strong>thousands of songs</strong> on Spotify but felt too lazy to actually organize them into playlists?</p>
            <p><strong>Same.</strong> This tool does the heavy lifting for you.</p>
            <div class="tour-actions">
              <button class="btn-small" onclick="closeTour()">Skip Tour</button>
              <button class="btn-primary" onclick="nextTourStep(2)">Let's Go! ‚Üí</button>
            </div>
          </div>
        </div>
        
        <div class="tour-step hidden" id="tour-step-2">
          <div class="tour-content">
            <h3>How It Works</h3>
            <p><strong>Step 1:</strong> Choose where to pull your music from:</p>
            <ul>
              <li><strong>Liked Songs</strong> - Perfect for large collections (cached for speed!)</li>
              <li><strong>Top Artists</strong> - Your most-listened artists</li>
              <li><strong>Playlists</strong> - Scan all your existing playlists</li>
            </ul>
            <p><strong>Step 2:</strong> We ask Spotify: "What genres are these artists?"</p>
            <p><strong>Step 3:</strong> Choose your view mode and select genres!</p>
            <div class="tour-actions">
              <button class="btn-small" onclick="prevTourStep(1)">‚Üê Back</button>
              <button class="btn-primary" onclick="nextTourStep(3)">Next ‚Üí</button>
            </div>
          </div>
        </div>
        
        <div class="tour-step hidden" id="tour-step-3">
          <div class="tour-content">
            <h3>Three Ways to View Genres</h3>
            <p>Spotify has 200+ messy micro-genres. We clean them up for you:</p>
            <ul>
              <li><strong>Genre Families</strong> - Grouped (House, Techno, Rock). One click = all sub-genres!</li>
              <li><strong>Detailed</strong> - Expandable families. Pick specific sub-genres if you want.</li>
              <li><strong>All Genres</strong> - Flat list of everything. For power users.</li>
            </ul>
            <p><strong>Tip:</strong> Start with "Genre Families" - it's the easiest!</p>
            <p><strong>Advanced:</strong> Click "Show Artists" on any genre to see which artists are included. You can even expand individual artists to see their tracks and uncheck specific songs!</p>
            <div class="tour-actions">
              <button class="btn-small" onclick="prevTourStep(2)">‚Üê Back</button>
              <button class="btn-primary" onclick="nextTourStep(4)">Next ‚Üí</button>
            </div>
          </div>
        </div>
        
        <div class="tour-step hidden" id="tour-step-4">
          <div class="tour-content">
            <h3>Bonus Features</h3>
            <p><strong>3-Level Control:</strong> Click "Show Artists" to see who's in each genre. Click "Show Tracks" to drill down to individual songs. Uncheck anything you don't want!</p>
            <p><strong>Manual Genre Mapping:</strong> See a genre in "Other" that should be elsewhere? Click the orange "Map to Family" button to assign it yourself. Your mappings are saved forever!</p>
            <p><strong>Export & Discovery:</strong> Download playlists as CSV/TXT for DJ software. Find similar artists from your library in the Artist Discovery tab.</p>
            <p><strong>Music Stats:</strong> See your top genres, diversity score, and fun insights about your taste!</p>
            <div class="tour-actions">
              <button class="btn-small" onclick="prevTourStep(3)">‚Üê Back</button>
              <button class="btn-primary" onclick="nextTourStep(5)">Next ‚Üí</button>
            </div>
          </div>
        </div>
        
        <div class="tour-step hidden" id="tour-step-5">
          <div class="tour-content">
            <h3>Your Privacy Matters</h3>
            <p><strong>No servers. No data storage.</strong></p>
            <p>Everything runs in <em>your browser</em>. We cache data locally for speed, but it never leaves your device.</p>
            <p style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #282828; font-size: 13px; color: #7f7f7f;">
              Open source ‚Ä¢ No ads ‚Ä¢ No tracking
            </p>
            <div class="tour-actions">
              <button class="btn-small" onclick="prevTourStep(4)">‚Üê Back</button>
              <button class="btn-primary" onclick="closeTour()">Start Using It</button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- About Section (Expandable) -->
      <div class="about-section">
        <button class="about-toggle" onclick="toggleAbout()">
          <span id="about-icon">‚ñ∂</span> Learn More: Behind the Scenes
        </button>
        <div id="about-content" class="about-content hidden">
          <div class="about-grid">
            <div class="about-card">
              <h4>The Problem</h4>
              <p>You love music. You save everything. But organizing 1,000+ songs into playlists? Ain't nobody got time for that.</p>
            </div>
            
            <div class="about-card">
              <h4>The Solution</h4>
              <p>Spotify knows each artist's genre. We fetch that data, <strong>intelligently group similar genres</strong> (because "deep house" and "house" should live together), and create playlists automatically. Magic? Nope, just smart API usage + pattern matching.</p>
            </div>
            
            <div class="about-card">
              <h4>Smart Genre Grouping</h4>
              <p>Spotify has 200+ micro-genres like "bubblegrunge" and "escape room." We auto-detect families (House, Techno, Hip-Hop) so you're not drowning in options. Choose your view: <strong>Grouped</strong> (simple), <strong>Detailed</strong> (expandable), or <strong>All</strong> (power user).</p>
            </div>
            
            <div class="about-card">
              <h4>3-Level Control</h4>
              <p>Ultimate playlist curation: <strong>Genre level</strong> (select styles), <strong>Artist level</strong> (exclude specific artists with "Show Artists"), <strong>Track level</strong> (cherry-pick individual songs with "Show Tracks"). See artist/track counts update in real-time as you curate.</p>
            </div>
            
            <div class="about-card">
              <h4>Why Caching?</h4>
              <p>Fetching 13,000 songs takes time. So we save it locally. Next visit? Instant load. Update when you add new music with the "Refresh Cache" button.</p>
            </div>
            
            <div class="about-card">
              <h4>Tech Stack</h4>
              <p><strong>Vanilla JavaScript</strong> + Spotify Web API + LocalStorage. No frameworks, no backend, no BS.</p>
            </div>
            
            <div class="about-card">
              <h4>Privacy First</h4>
              <p>Zero data leaves your browser. No analytics, no tracking, no servers. Your Spotify token expires after an hour.</p>
            </div>
            
            <div class="about-card">
              <h4>Pro Tips</h4>
              <p>‚Ä¢ Start with "Genre Families" view - cleanest<br>
              ‚Ä¢ Use "Detailed" to cherry-pick sub-genres<br>
              ‚Ä¢ Click "Show Artists" to see & exclude specific artists<br>
              ‚Ä¢ Click "Show Tracks" for song-level control<br>
              ‚Ä¢ Orange "Map to Family" button on unmapped genres<br>
              ‚Ä¢ Use "Merged" mode for large genre mixes<br>
              ‚Ä¢ Export playlists for DJ software<br>
              ‚Ä¢ Top Artists mode = instant discovery</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Tab Navigation -->
      <div class="tabs">
        <button class="tab-btn active" data-tab="library">My Library</button>
        <button class="tab-btn" data-tab="artist">Artist Discovery</button>
        <button class="tab-btn" data-tab="stats">Music Stats</button>
        <button class="tab-btn" data-tab="history">Playlist History</button>
      </div>

      <!-- Tab Content: My Library -->
      <div id="library-tab" class="tab-content active">
        <h2>Create Playlist from Your Music Library</h2>
        
        <!-- Data Source Selection -->
        <div class="data-source-options">
          <h4 style="color: #e3e3e3; margin-bottom: 12px;">
            What music should we dig into?
            <span class="tooltip">i
              <span class="tooltiptext">Pick where to pull your tracks from. Liked Songs is cached for speed!</span>
            </span>
          </h4>
          <label>
            <input type="radio" name="data-source" value="liked-songs" checked>
            <span>Songs I've liked</span>
          </label>
          <div class="option-description">Your entire liked songs collection - perfect for big libraries!</div>
          
          <label>
            <input type="radio" name="data-source" value="top-artists">
            <span>Artists I listen to most</span>
          </label>
          <div class="option-description">Your top 50 most-played artists - quick and personalized</div>
          
          <label>
            <input type="radio" name="data-source" value="playlists">
            <span>All my playlists</span>
          </label>
          <div class="option-description">Scan everything - your created playlists, saved ones, and followed ones</div>
        </div>
        
        <div class="library-controls">
          <button id="fetch-tracks" class="btn-secondary">Let's Go</button>
          <button id="refresh-cache" class="btn-small" style="display: none;">Refresh Cache</button>
          <div id="cache-info" class="cache-info" style="display: none;"></div>
        </div>

        <!-- Genre Selection Area -->
        <div id="genre-selection-area" class="hidden">
          <div class="genre-header">
            <h3>Select Genres for Your Playlist</h3>
            <div class="genre-actions">
              <select id="genre-view-mode" class="view-mode-select">
                <option value="families">Genre Families (Grouped)</option>
                <option value="detailed">Detailed (Expandable)</option>
                <option value="all">All Genres (Flat)</option>
              </select>
              <input type="text" id="genre-filter" placeholder="Filter genres..." />
              <input type="text" id="unmapped-filter" class="hidden" placeholder="Filter unmapped..." />
              <button id="show-unmapped-btn" class="btn-small hidden">Show Unmapped (<span id="unmapped-count">0</span>)</button>
              <button id="show-all-btn" class="btn-small hidden">Show All</button>
              <button id="select-all-genres" class="btn-small">Select All</button>
              <button id="clear-genres" class="btn-small">Clear All</button>
            </div>
          </div>
          
          <div id="genre-stats" class="genre-stats"></div>
          
          <div class="genre-tip-card">
            <span class="genre-tip-icon">Tip:</span>
            <span class="genre-tip-text">
              Want to learn about genre history and relationships? Check out 
              <a href="https://musicmap.info/" target="_blank" class="genre-tip-link">MusicMap.info</a>
            </span>
          </div>
          
          <div id="genre-grid" class="genre-grid"></div>
          
          <!-- Floating Create Playlist Button -->
          <div id="floating-create-btn" class="floating-create-btn hidden">
            <button class="fab-button" onclick="scrollToPlaylistControls()">
              <span class="fab-icon">üéµ</span>
              <span class="fab-text">Create Playlist</span>
              <span class="fab-count" id="fab-count">0 selected</span>
            </button>
          </div>
          
          <!-- Playlist Mode Options -->
          <div class="playlist-options">
            <h4 style="color: #e3e3e3; margin-bottom: 12px;">
              How should we organize this?
              <span class="tooltip">i
                <span class="tooltiptext">Merged = one big playlist. Separate = individual playlists per genre.</span>
              </span>
            </h4>
            <label>
              <input type="radio" name="playlist-mode" value="merged" checked>
              <span>Merge into one playlist</span>
            </label>
            <div class="option-description">Combine all selected genres into one epic playlist</div>
            
            <label>
              <input type="radio" name="playlist-mode" value="separate">
              <span>Create separate playlists</span>
            </label>
            <div class="option-description">Make individual playlists for each genre (power user mode!)</div>
          </div>
          
          <div class="playlist-controls">
            <input type="text" id="playlist-name" placeholder="Name your playlist (or we'll name it for you!)" />
            <button id="create-library-playlist" class="btn-primary" disabled>Create Playlist</button>
          </div>
        </div>
      </div>

      <!-- Tab Content: Artist Discovery -->
      <div id="artist-tab" class="tab-content">
        <h2>Discover Music from Any Artist</h2>
        <p style="color: #b3b3b3; font-size: 14px; margin: -10px 0 20px 0;">
          Search for any artist, then find similar artists <strong>from your own library</strong> based on matching genres. Perfect for building playlists around a specific sound!
        </p>
        
        <!-- Artist Search -->
        <div class="search-container">
          <input 
            type="text" 
            id="artist-search" 
            placeholder="Search for an artist (e.g., Tame Impala, Arctic Monkeys)..."
            autocomplete="off"
          />
          <div id="search-results" class="search-results"></div>
        </div>

        <!-- Selected Artist Display -->
        <div id="selected-artist" class="selected-artist hidden">
          <h3>Selected Artist</h3>
          <div id="artist-card" class="artist-card"></div>
          <button id="find-related" class="btn-secondary">Find Similar Artists (from your library)</button>
        </div>

        <!-- Related Artists Grid -->
        <div id="related-artists-section" class="hidden">
          <h3>Similar Artists from Your Library <span class="hint">(ranked by matching genres - click to select)</span></h3>
          <div id="related-artists-grid" class="artists-grid"></div>
          
          <div class="playlist-controls">
            <input type="text" id="discovery-playlist-name" placeholder="Playlist name (optional)" />
            <button id="generate-discovery-playlist" class="btn-primary">Generate Playlist</button>
          </div>
        </div>
      </div>

      <!-- Tab Content: Music Stats -->
      <div id="stats-tab" class="tab-content">
        <div class="stats-container">
          <h2>Your Music Profile</h2>
          <div id="stats-content" class="stats-placeholder">
            <p>Load your music library first to see your personalized stats.</p>
            <p style="color: #7f7f7f; font-size: 14px; margin-top: 10px;">Go to "My Library" tab and click "Let's Go!" to analyze your music taste.</p>
          </div>
        </div>
      </div>

      <!-- Tab Content: Playlist History -->
      <div id="history-tab" class="tab-content">
        <div class="playlist-history">
          <h3>Your Created Playlists</h3>
          <div id="history-list" class="history-list">
            <div class="history-empty">No playlists created yet. Start creating!</div>
          </div>
        </div>
      </div>

      <!-- Status Messages -->
      <div id="status" class="status-box">Ready to start!</div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
































